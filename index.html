<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Btn Testing</title>
  <meta name="description" content="The HTML5 Herald">
  <meta name="author" content="SitePoint">

  <!--<link rel="stylesheet" href="css/styles.css?v=1.0">-->

</head>

<body>
    <h2>Testing 302.0</h2>
		
<style type='text/css'>
	.embeddedServiceHelpButton .helpButton .uiButton {
		background-color: #005290;
		font-family: "Arial", sans-serif;
	}
	.embeddedServiceHelpButton .helpButton .uiButton:focus {
		outline: 1px solid #005290;
	}
	.testBTNClass {
		background-color: #005290;
	}
	.disableLiveChatButton {
   		pointer-events: none;
	}
</style>

<script type='text/javascript' src='https://service.force.com/embeddedservice/5.0/esw.min.js'></script>
<script type='text/javascript'>
	var initESW = function(gslbBaseURL) {
		embedded_svc.settings.displayHelpButton = true; //Or false
		embedded_svc.settings.language = ''; //For example, enter 'en' or 'en-US'
			
		embedded_svc.settings.extraPrechatFormDetails = [{
		  "label": "First Name",
		  "transcriptFields":[ "Visitor_First_Name__c" ],
		  "displayToAgent": true
		}, {
		  "label": "Last Name",
		  "transcriptFields":[ "Visitor_Last_Name__c" ],
		  "displayToAgent": true
		}, {
		  "label": "Email",
		  "transcriptFields":[ "Visitor_Email__c" ],
		  "displayToAgent": true
		}, {
		  "label": "Company",
		  "transcriptFields":[ "Visitor_Company__c" ],
		  "displayToAgent": true
		}];

		embedded_svc.settings.defaultMinimizedText = 'Let\'s Chat'; //(Defaults to Chat with an Expert)
		embedded_svc.settings.disabledMinimizedText = 'Chat Offline'; //(Defaults to Agent Offline)

		//embedded_svc.settings.loadingText = ''; //(Defaults to Loading)
		//embedded_svc.settings.storageDomain = 'yourdomain.com'; //(Sets the domain for your deployment so that visitors can navigate subdomains during a chat session)

		// Settings for Chat
		embedded_svc.settings.directToButtonRouting = function(prechatFormData) {
		// Dynamically changes the button ID based on what the visitor enters in the pre-chat form.
		// Returns a valid button ID.
			if(prechatFormData[4].value === "A product question or recommendation"){
				console.log("Routing to Inside Sales...");	
				//console.log(prechatFormData[4].value);	
				return "5732100000001MY";
			}
			else if(prechatFormData[4].value === "My existing order or account information"){
				console.log("Routing to Inside Sales...");
				//console.log(prechatFormData[4].value);
				return "5732100000001MY";
			}
			else if(prechatFormData[4].value === "Printer or software support"){
				console.log("Routing to Tech Support...");
				//console.log(prechatFormData[4].value);
				return "5732100000001Md";
			}
		};
		//embedded_svc.settings.prepopulatedPrechatFields = {}; //Sets the auto-population of pre-chat form fields
		//embedded_svc.settings.fallbackRouting = []; //An array of button IDs, user IDs, or userId_buttonId
		//embedded_svc.settings.offlineSupportMinimizedText = '...'; //(Defaults to Contact Us)

		embedded_svc.settings.enabledFeatures = ['LiveAgent'];
		embedded_svc.settings.entryFeature = 'LiveAgent';

		embedded_svc.init(
			'https://brady--americas.my.salesforce.com',
			'https://americas-brady.cs26.force.com/docs',
			gslbBaseURL,
			'00D21000000ABDj',
			'Lightning_Inside_Sales',
			{
				baseLiveAgentContentURL: 'https://c.la4-c1cs-phx.salesforceliveagent.com/content',
				deploymentId: '5722100000001K8',
				buttonId: '5732100000001MY',
				baseLiveAgentURL: 'https://d.la4-c1cs-phx.salesforceliveagent.com/chat',
				eswLiveAgentDevName: 'EmbeddedServiceLiveAgent_Parent04I210000008OO8EAM_170372ceb28',
				isOfflineSupportEnabled: false
			}
		);
	};

	if (!window.embedded_svc) {
		console.log("in load...");
		var s = document.createElement('script');
		s.setAttribute('src', 'https://brady--americas.my.salesforce.com/embeddedservice/5.0/esw.min.js');
		s.onload = function() {
			initESW(null);
			console.log("on load...");
			console.log(document.querySelector('#helpButtonSpan'));
		};
		//myFunction2();
		document.body.appendChild(s);
		
	} else {
		
		//console.log("in else...");
		//setInterval(function(){ console.log(document.querySelector(".message")); }, 8000);
		//console.log(document.querySelector('#helpButtonSpan'));
		initESW('https://service.force.com');
		//console.log(document.querySelector('#helpButtonSpan'));
	}
</script>
	
	
	
<script>
function myFunction() {
	//console.log('getElementsByClassName[0]');
  document.getElementsByClassName("helpButtonEnabled")[0].click()
}
</script>
	
	
	<!--
        <button onclick = "gfg_Run()">  
            Change 
        </button> 
	-->
	
	<br>
	<br>
	
	
	
        <script> 
            var span2 = document.getElementsByClassName("message"); 
            //var el_down = document.getElementById("GFG_DOWN"); 
              
            function gfg_Run() { 
                span2[0].textContent = "Chat Now"; 
                //el_down.innerHTML = "Span content changed"; 
            }          
        </script> 	
	
	
	
	
	
	
	
<form>
<!--
	<button class="testBTNClass" id="myTopButtonId" type="button" onclick="myFunction()">Offline</button>
-->
<!--<input type="checkbox" id="myCheck" onmouseover="myFunction()" onclick="">-->
</form>
	
	
	
<!-- [TEST] test comment -->	

	<br>
	<br>
	
<div class="BR-UtilityNavLink BR-HasImg" id="liveagentbutton" onclick="openChatButton()" style="cursor: pointer">
    <svg class="BR-UtilityNavIcon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 14V3.2A3.1 3.1 0 0 1 3 0h18a3.1 3.1 0 0 1 3 3.2v10.7a3.1 3.1 0 0 1-3.1 3.2h-1.8l.4 6.9-6.7-6.9H3.3A3.3 3.3 0 0 1 0 14z" fill="#1779ba" /></svg>
    <span id="chattext">Let's Chat</span>
</div>	
	
<script>
	/*
function openChatButton() {
  var chatButtonElement = document.getElementsByClassName("helpButtonEnabled");
  if(chatButtonElement[0]){  
	chatButtonElement[0].click();
  }
}
*/
</script>
	
<script>
/*	
function checkBrowser() {
	
	let IExplorerAgent = window.navigator.userAgent.match(/(MSIE|Trident)/);
	if (IExplorerAgent) {
		//console.log("User is using IE? " + IExplorerAgent);
		//alert("User is using IE");
		//console.log("IE USER.");
		
	    document.getElementById('myTopButtonId').innerHTML = 'Default Chat Text';
            document.getElementById('myTopButtonId').disabled = false;	
		
	    document.getElementById('chattext').innerHTML = 'Default Chat Text';
	    document.getElementById('liveagentbutton').classList.remove("disableLiveChatButton");
	    
	    }
	
	
}
	
*/	
	//window.onload = checkBrowser();
	//window.addEventListener('DOMContentLoaded', (event) => {
		  //let userAgentString = navigator.userAgent; 
		//console.log("LOADED...");
		

//});
	
</script>	
	
	
<!-- <span id="root" class="rootSpanWording">loading...</span> -->	
	
<script>
      //setTimeout(function() {
	 //     console.log('Changed the span text!');
       // document.getElementById('root').innerHTML = "loaded...";
     // }, 3000);
</script>		
	
		

<script type='text/javascript'>
    //[CREATED] function that attempts to open the chat button, fixes bug where if Chat is Offline it will not open the chat on User click of button
    function openChatButton() {
        var chatButtonElement = document.getElementsByClassName("helpButtonEnabled");
            if(chatButtonElement[0]){  
                chatButtonElement[0].click();
            }
    }
    //[UPDATED] to check if the browser isn't IE, if so change button text dynamically
    let IExplorerAgent = window.navigator.userAgent.match(/(MSIE|Trident)/);
    if(!IExplorerAgent) {
        //Provide browser support for MutationObserver
        var MutationObserver = window.MutationObserver || window.WebKitMutationObserver || window.MozMutationObserver;
        var observer = new MutationObserver(function (mutations) {
            //Detect when the chat button text changes from the OFFLINE Message to the ONLINE Message
            mutations.forEach(function (mutation) {
                //Replace the "Chat Now" value with the button ONLINE Message that was configured
                if (mutation.type === 'childList' && mutation.target.nodeName === 'SPAN' && mutation.target.className === 'message' && mutation.target.innerHTML == 'Let\'s Chat') {
                    //Change the text of the top button with the ONLINE Message and enable it so it is clickable
                    //Replace the "myTopButtonId" with the button id of the top button
                    document.getElementById('chattext').innerHTML = mutation.target.innerHTML;
                    // [UPDATED] div element to be disabled via css since it is not a button
                    document.getElementById('liveagentbutton').classList.remove("disableLiveChatButton");
                    //document.getElementById('liveagentbutton').disabled = false;
                }
                //Replace the "Offline" value with the button OFFLINE Message that was configured
                else if (mutation.type === 'childList' && mutation.target.nodeName === 'SPAN' && mutation.target.className === 'message' && mutation.target.innerHTML == 'Chat Offline') {
                    //Change the text of top button with the OFFLINE Message and disable it so it can't be clicked
                    //Replace the "myTopButtonId" with the button id of the top button
                    document.getElementById('chattext').innerHTML = mutation.target.innerHTML;
                    // [UPDATED] div element to be disabled via css since it is not a button 
                    document.getElementById('liveagentbutton').classList.add("disableLiveChatButton"); 
                    //document.getElementById('liveagentbutton').disabled = true;
                }
            });
        });

        //Start the observer
        observer.observe(document, {
            childList: true,
            subtree: true
        });
    }   else {
        //[UPDATED] check if User is using IE, display static button text if so
        document.getElementById('chattext').innerHTML = 'Let\'s Chat';
    }	    
	    
/*	    
var insertedNodes = [];
var observer = new MutationObserver(function(mutations) {
 mutations.forEach(function(mutation) {
	 
	 console.log(mutation.type);
	 console.log(mutation.nodeValue);
   for (var i = 0; i < mutation.addedNodes.length; i++)
     insertedNodes.push(mutation.addedNodes[i]);
 })
});
observer.observe(document, { childList: true });
console.log(insertedNodes);	    
//here	    
*/	 
	    
	    
	    
	    
	    
	    
/*	    
	    const observer = new MutationObserver(function
(mutations) {
 mutations.forEach(function (mutation) {
	if (mutation.addedNodes.length) {
   		console.log(mutation.addedNodes[0]);
   }
 })
})
const bears = document.querySelector('#helpButtonSpan');
	    console.log("helpButtonSpan");
	    console.log(document.querySelector('#helpButtonSpan'));
	    console.log(document.querySelectorAll(".rootSpanWording")[0]);
	    console.log(document.querySelector('#root'));
observer.observe(bears, {
childList: true
});
*/	    
	    /*
	    function myFunction2() {
	// Select the node that will be observed for mutations
	//const targetNode = document.getElementById('root');
	const targetNode = document.getElementsByClassName("helpButtonEnabled")[0];
	console.log(document.getElementsByClassName("helpButtonEnabled")[0]);    
	// Options for the observer (which mutations to observe)
	const config = { attributes: true, childList: true, subtree: true, characterData:true, attributeOldValue : true };
	// Callback function to execute when mutations are observed
	const callback = function(mutationsList, observer) {
	    // Use traditional 'for loops' for IE 11
	    for(let mutation of mutationsList) {
		if (mutation.type === 'childList') {
			//var btn3 = document.getElementById("root");
			//btn3.value = 'online, chat us'; // will just add a hidden value
			//btn3.innerHTML = 'online, chat us';
		    //document.getElementById("myCheck").disabled = false;
		    console.log('A child node has been added or removed. v2');
		    console.log(targetNode.value);	
		    console.log(targetNode.innerHTML);	
		    console.log(mutation);		
		}
		else if (mutation.type === 'attributes') {
		    console.log('The ' + mutation.attributeName + ' attribute was modified...');
		}
	    }
	};
	// Create an observer instance linked to the callback function
	const observer = new MutationObserver(callback);
	// Start observing the target node for configured mutations
	observer.observe(targetNode, config);
	    }
	    
	    */
</script>	
	
	
	
<!--	
	<ul id="myList">
  <li>Coffee</li>
  <li>Tea</li>
</ul>
<button onclick="myFunction200()">Try it</button>
-->

	
<script>
	/*
function myFunction200() {
  var node200 = document.createElement("LI");
  var textnode = document.createTextNode("Water");
  node200.appendChild(textnode);
  document.getElementById("myList").appendChild(node200);
}
*/
</script>

</body>
</html>
